<!-- pages/home/index.wxml -->

<view class="container">
  <!-- iPad 三栏布局 -->
  <view class="home-layout">
    
    <!-- 左侧导航组件 -->
    <sidebar-nav activeNav="首页" userAvatar="{{userAvatar}}"></sidebar-nav>

    <!-- 右侧主内容区 -->
    <view class="home-main">
      <!-- 顶部问候语 -->
      <view class="main-header">
        <view class="header-left">
          <view class="greeting">你好，{{userName}}</view>
          <view class="sub-greeting">今天是你的练习第 {{practiceDays}} 天，AI 为你准备了新的复盘建议。</view>
        </view>
        <view class="header-right">
          <view class="date-display">
            <text class="calendar-icon">📅</text>
            <text>{{currentDate || '2025年12月27日'}}</text>
          </view>
        </view>
      </view>

      <view class="dashboard-content">
        <!-- 左侧大卡片：今日练习概览 -->
        <view class="overview-card">
          <view class="card-header">
            <view class="card-title-box">
              <text class="trend-icon">📈</text>
              <text class="card-title">今日练习概览</text>
            </view>
          </view>

          <view class="stats-row">
            <view class="stat-item">
              <view class="stat-label">今日练习总次数</view>
              <view class="stat-value-box">
                <text class="stat-value">{{todayStats.total}}</text>
                <text class="stat-unit">次</text>
              </view>
            </view>
            <view class="stat-item">
              <view class="stat-label">今日背诵完成</view>
              <view class="stat-value-box">
                <text class="stat-value">{{todayStats.memory}}</text>
                <text class="stat-unit">条</text>
              </view>
            </view>
            <view class="stat-item">
              <view class="stat-label">热点训练</view>
              <view class="stat-value-box">
                <text class="stat-value">{{todayStats.hot}}</text>
                <text class="stat-unit">篇</text>
              </view>
            </view>
          </view>

          <view class="chart-section">
            <view class="chart-header">
              <text class="chart-title">本周练习趋势</text>
              <text class="chart-progress">背诵目标完成度: {{memoryProgress}}%</text>
            </view>
            <view class="chart-container">
              <view class="chart-bars">
                <view 
                  wx:for="{{weekTrend}}" 
                  wx:key="index" 
                  class="chart-bar-item"
                >
                  <view class="bar-fill" style="height: {{item}}%"></view>
                </view>
              </view>
              <view class="chart-labels">
                <text>周一</text><text>周二</text><text>周三</text><text>周四</text><text>周五</text><text>周六</text><text>周日</text>
              </view>
              <view class="chart-progress-line">
                <view class="progress-line-fill" style="width: {{memoryProgress}}%"></view>
              </view>
            </view>
          </view>
        </view>

        <!-- 右侧栏 -->
        <view class="side-content">
          <!-- AI 复盘建议 -->
          <view class="ai-card">
            <view class="ai-card-header">
              <text class="ai-icon">✨</text>
              <text class="ai-title">AI 复盘建议</text>
            </view>
            <view class="ai-content">
              “{{aiSuggestion}}”
            </view>
          </view>

          <!-- 快捷操作列表 -->
          <view class="action-list">
            <view class="action-item" bindtap="goToHotList">
              <view class="action-left">
                <text class="action-icon fire">🔥</text>
                <text class="action-name">今日热点</text>
              </view>
              <view class="action-right">
                <text class="action-badge">{{hotCount}} 条</text>
                <text class="arrow-icon">→</text>
              </view>
            </view>

            <view class="action-item" bindtap="goToHotTrain">
              <view class="action-left">
                <text class="action-icon pen">🖋️</text>
                <text class="action-name">开始热点训练</text>
              </view>
              <view class="action-right">
                <text class="arrow-icon">→</text>
              </view>
            </view>

            <view class="action-item" bindtap="goToMemory">
              <view class="action-left">
                <text class="action-icon book">📖</text>
                <text class="action-name">今日背诵任务</text>
              </view>
              <view class="action-right">
                <text class="action-badge green">{{pendingMemoryCount}} 条待背</text>
                <text class="arrow-icon">→</text>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>
