<!-- pages/home/index.wxml - React Minimalist Design -->

<view class="container">
  <!-- iPad ä¸‰æ å¸ƒå±€ -->
  <view wx:if="{{isPad}}" class="home-layout">
    
    <!-- å·¦ä¾§å¯¼èˆª -->
    <view class="home-nav">
      <view class="nav-header">
        <view class="app-icon">ğŸ“‹</view>
        <text class="app-name">ç”³è®º AI åŠ©æ‰‹</text>
      </view>
      
      <view class="nav-list">
        <view 
          wx:for="{{navItems}}" 
          wx:key="name"
          class="nav-item {{activeNav === item.name ? 'active' : ''}}"
          data-name="{{item.name}}"
          data-route="{{item.route}}"
          bindtap="onNavItemTap"
        >
          <text class="nav-item-icon">{{item.icon}}</text>
          <text class="nav-item-text">{{item.name}}</text>
        </view>
      </view>
    </view>

    <!-- ä¸­é—´ä¸»å†…å®¹åŒº -->
    <view class="home-main">
      <view class="main-content">
        
        <!-- æ¬¢è¿å¡ç‰‡ -->
        <view class="welcome-section">
          <view class="welcome-left">
            <view class="welcome-title">ä½ å¥½ï¼Œ{{userNickname || 'åŒå­¦'}}</view>
            <view class="welcome-subtitle">ä»Šå¤©çš„ç”³è®ºçµæ„Ÿå·²ç»å‡†å¤‡å¥½äº†ï¼Œå¼€å§‹ç»ƒä¹ å§ã€‚</view>
          </view>
          <view class="welcome-right">
            <view class="progress-label">
              <text class="progress-label-text">TODAY</text>
            </view>
            <view class="progress-value">
              <text class="progress-number">{{todayTasksCompleted}}/{{todayTasksTotal}}</text>
              <text class="progress-unit">ä»»åŠ¡</text>
            </view>
            <view class="progress-ring">
              <view class="ring-bg"></view>
              <view class="ring-fill"></view>
              <text class="ring-icon">ğŸ¯</text>
            </view>
          </view>
          <view class="welcome-decoration">ğŸ“š</view>
        </view>

        <!-- ä¸‰ä¸ªå¿«æ·å…¥å£ -->
        <view class="quick-actions">
          <view 
            wx:for="{{quickActions}}" 
            wx:key="title"
            class="action-card"
            data-route="{{item.route}}"
            bindtap="onQuickActionTap"
          >
            <view class="action-content">
              <view class="action-icon" style="background-color: {{item.color}};">
                <text class="action-icon-text">{{item.icon}}</text>
              </view>
              <view class="action-text">
                <view class="action-title">{{item.title}}</view>
                <view class="action-desc">{{item.desc}}</view>
              </view>
            </view>
            <view class="action-arrow">
              <view class="arrow-btn">â†’</view>
            </view>
          </view>
        </view>

        <!-- æœ€è¿‘ç»ƒä¹  -->
        <view class="recent-section">
          <view class="section-header">
            <text class="section-title">æœ€è¿‘ç»ƒä¹ </text>
            <text class="section-link" bindtap="goToHotTraining">æŸ¥çœ‹å…¨éƒ¨</text>
          </view>
          <view class="exercise-list">
            <view 
              wx:for="{{recentExercises}}" 
              wx:key="title"
              class="exercise-item"
              data-index="{{index}}"
              bindtap="onExerciseTap"
            >
              <view class="exercise-left">
                <view class="exercise-icon">ğŸ•</view>
                <view class="exercise-info">
                  <view class="exercise-title">{{item.title}}</view>
                  <view class="exercise-meta">
                    <text class="exercise-tag">{{item.type}}</text>
                    <text class="exercise-time">{{item.time}}</text>
                  </view>
                </view>
              </view>
              <view class="exercise-right">
                <view class="exercise-status {{item.statusType}}">
                  <text class="status-icon">{{item.statusType === 'completed' ? 'âœ“' : 'â—'}}</text>
                  <text class="status-text">{{item.status}}</text>
                </view>
                <text class="exercise-chevron">â€º</text>
              </view>
            </view>
          </view>
        </view>

      </view>
    </view>

    <!-- å³ä¾§è¾…åŠ©æ  -->
    <view class="home-aside" wx:if="{{showRightPanel}}" style="width: {{rightPanelWidth}}px;">
      <!-- è°ƒæ•´æ‰‹æŸ„ -->
      <view 
        class="resize-handle" 
        catchtouchstart="startResize"
        catchtouchmove="onResize"
        catchtouchend="endResize">
        <view class="resize-line"></view>
      </view>
      
      <!-- éšè—æŒ‰é’® -->
      <view class="panel-toggle-btn" bindtap="toggleRightPanel">
        <text class="toggle-icon">â€º</text>
      </view>
      
      <view class="aside-content">
        
        <!-- ä»Šæ—¥æé†’ -->
        <view class="reminder-section">
          <view class="aside-section-header">
            <text class="aside-icon">ğŸ’¡</text>
            <text class="aside-label">{{todayReminder.title}}</text>
          </view>
          <view class="reminder-list">
            <view class="reminder-card primary" bindtap="onTodayReminderTap">
              <view class="reminder-text">
                {{todayReminder.text}}
              </view>
              <view class="reminder-action">
                <text>{{todayReminder.actionText}}</text>
                <text class="action-arrow-small">â†’</text>
              </view>
            </view>
            <view class="reminder-card secondary">
              <view class="reminder-text">
                è·ç¦»ä¸‹æ¬¡çœŸé¢˜æ¨¡æ‹Ÿç»ƒä¹ è¿˜æœ‰ 2 å¤©ï¼Œè¯·ä¿æŒæ‰‹æ„Ÿã€‚
              </view>
            </view>
          </view>
        </view>

        <!-- æœ¬å‘¨ç»Ÿè®¡ -->
        <view class="stats-section">
          <view class="aside-section-header">
            <view style="display: flex; align-items: center;">
              <text class="aside-icon">ğŸ“ˆ</text>
              <text class="aside-label">æœ¬å‘¨ç»Ÿè®¡</text>
            </view>
            <text class="aside-link" bindtap="goToMe" style="font-size: 12px; color: #5A7D9A;">æŸ¥çœ‹å­¦ä¹ æŠ¥å‘Š ></text>
          </view>
          <view class="stats-grid">
            <view class="stat-item">
              <view class="stat-label">å†™æ–‡ç« </view>
              <view class="stat-value">
                <text class="stat-number">{{weekStats.essayCount}}</text>
                <text class="stat-unit">ç¯‡</text>
              </view>
            </view>
            <view class="stat-item">
              <view class="stat-label">ç§¯ç´¯ç´ æ</view>
              <view class="stat-value">
                <text class="stat-number">{{weekStats.materialCount}}</text>
                <text class="stat-unit">æ¡</text>
              </view>
            </view>
          </view>

          <!-- æ´»è·ƒåº¦åˆ†å¸ƒ -->
          <view class="activity-chart">
            <view class="chart-header">
              <text class="chart-label">æ´»è·ƒåº¦åˆ†å¸ƒ</text>
              <text class="chart-growth">{{weekStats.weekGrowth}} ä¸Šå‘¨</text>
            </view>
            <view class="chart-bars">
              <view 
                wx:for="{{weekStats.activityData}}" 
                wx:key="*this"
                class="chart-bar {{index === 3 ? 'active' : ''}}"
                style="height: {{item}}%;"
              ></view>
            </view>
            <view class="chart-labels">
              <text class="chart-day">Mon</text>
              <text class="chart-day">Sun</text>
            </view>
          </view>
        </view>

      </view>
    </view>

  </view>

  <!-- æ˜¾ç¤ºæŒ‰é’®ï¼ˆå½“å³ä¾§æ éšè—æ—¶ï¼‰ -->
  <view class="panel-show-btn" wx:if="{{!showRightPanel}}" bindtap="toggleRightPanel">
    <text class="toggle-icon">â€¹</text>
  </view>

  <!-- æ‰‹æœºå•æ å¸ƒå±€ -->
  <view wx:else class="phone-layout">
    <view class="phone-welcome">
      <view class="phone-greeting">
        <text class="phone-greeting-text">ä½ å¥½ï¼Œ{{userNickname || 'åŒå­¦'}}</text>
        <text class="phone-greeting-emoji">ğŸ‘‹</text>
      </view>
      <view class="phone-progress">
        <text class="phone-progress-text">ä»Šæ—¥ä»»åŠ¡ {{todayTasksCompleted}}/{{todayTasksTotal}}</text>
      </view>
    </view>

    <view class="phone-actions">
      <view 
        wx:for="{{quickActions}}" 
        wx:key="title"
        class="phone-action-card"
        data-route="{{item.route}}"
        bindtap="onQuickActionTap"
      >
        <view class="phone-action-icon" style="background-color: {{item.color}};">
          <text>{{item.icon}}</text>
        </view>
        <view class="phone-action-info">
          <view class="phone-action-title">{{item.title}}</view>
          <view class="phone-action-desc">{{item.desc}}</view>
        </view>
        <text class="phone-action-arrow">â€º</text>
      </view>
    </view>

    <view class="phone-recent">
      <view class="phone-section-title">æœ€è¿‘ç»ƒä¹ </view>
      <view 
        wx:for="{{recentExercises}}" 
        wx:key="title"
        class="phone-exercise-item"
        data-index="{{index}}"
        bindtap="onExerciseTap"
      >
        <view class="phone-exercise-title">{{item.title}}</view>
        <view class="phone-exercise-footer">
          <text class="phone-exercise-tag">{{item.type}}</text>
          <text class="phone-exercise-time">{{item.time}}</text>
          <text class="phone-exercise-status {{item.statusType}}">{{item.status}}</text>
        </view>
      </view>
    </view>
  </view>
</view>
