<view class="container">
  <!-- ä¾§è¾¹å¯¼èˆªæ  (Global Sidebar) -->
  <sidebar-nav activeNav="çƒ­ç‚¹è®­ç»ƒ" userAvatar="{{userAvatar}}"></sidebar-nav>

  <!-- ä¸»å†…å®¹åŒº -->
  <view class="main-wrapper">
    <!-- Header -->
    <header class="editor-header">
      <view class="header-left">
        <view class="back-btn" bindtap="goBack">
          <text class="icon-chevron-left">ã€ˆ</text>
        </view>
        <view class="divider-v"></view>
        <view class="status-info">
          <text class="zap-icon">âš¡</text>
          <text class="status-label">æ­£åœ¨è¿›è¡Œï¼š</text>
          <text class="status-text">{{statusTitle}}</text>
        </view>
        <view class="badge-training">åˆ†è®ºç‚¹è®­ç»ƒ</view>
      </view>
      <view class="header-right">
        <!-- æŒ‰é’®å·²ç§»è‡³ä¸‹æ–¹ -->
      </view>
    </header>

    <view class="content-body">
      <!-- Left: Context / Reference -->
      <aside class="context-sidebar">
        <view class="context-header">
          <text class="context-title">æ¨èç´ æ</text>
          <view class="badge-outline">2 æ¡</view>
        </view>
        <scroll-view scroll-y class="context-scroll">
          <view class="material-cards">
            <view class="material-card" wx:for="{{recommendedMaterials}}" wx:key="index">
              <view class="card-tag">
                <text class="tag-dot {{item.type === 'é‡‘å¥' ? 'amber' : 'emerald'}}"></text>
                <text class="tag-label">{{item.type}}</text>
              </view>
              <view class="card-content">
                <text class="serif-text">{{item.content}}</text>
              </view>
            </view>
          </view>
        </scroll-view>
      </aside>

      <!-- Middle: Writing IDE -->
      <main class="writing-ide">
        <view class="ide-container">
          <view class="ide-header">
            <view class="topic-title">çƒ­ç‚¹ï¼š{{topicTitle}}</view>
            <view class="goal-text">ç›®æ ‡ï¼š{{goalText}}</view>
          </view>

          <!-- ææ–™æ‘˜è¦ä¸å…¨æ–‡ -->
          <view class="material-preview-section">
            <view class="material-preview">
              <text class="material-title">ææ–™æ‘˜è¦</text>
              <text class="material-snippet">{{materialSnippet}}</text>
              <button class="material-more" bindtap="toggleMaterialFull">
                {{showFullMaterial ? 'æ”¶èµ·ææ–™' : 'å±•å¼€æŸ¥çœ‹å…¨æ–‡'}}
              </button>
            </view>

            <scroll-view
              wx:if="{{showFullMaterial}}"
              scroll-y="true"
              class="material-full"
            >
              <text class="material-full-text">{{materialFull}}</text>
            </scroll-view>
          </view>

          <view class="tabs-container">
            <view class="tabs-list">
              <view 
                class="tab-trigger {{activeTabIndex === index ? 'active' : ''}}" 
                wx:for="{{tabs}}" 
                wx:key="index"
                bindtap="onTabTap"
                data-index="{{index}}"
              >
                {{item}}
              </view>
            </view>
            
            <view class="editor-wrapper">
              <textarea 
                class="writing-textarea" 
                placeholder="å¦‚ï¼šæ•°å­—åŒ–èµ‹èƒ½ä¹¡æ‘æ²»ç†ï¼Œæå‡å…¬å…±æœåŠ¡è§¦è¾¾æ•ˆç‡â€¦â€¦" 
                value="{{currentParagraph}}"
                bindinput="onInput"
                maxlength="1000"
                placeholder-class="textarea-placeholder"
              ></textarea>
              
              <view class="editor-actions">
                <text class="word-count">å·²è¾“å…¥ {{wordCount}} å­—</text>
                <view class="actions-column">
                  <view class="btn-outline-sm finish-btn" bindtap="finishParagraph">å®Œæˆæœ¬æ®µ</view>
                  <view class="secondary-actions">
                    <view class="btn-ghost-sm" bindtap="saveDraft">
                      <text class="icon-save">ğŸ’¾</text>
                      <text>æš‚å­˜</text>
                    </view>
                    <view class="btn-primary-sm" bindtap="generateAIComment">
                      <text class="icon-sparkles">âœ¨</text>
                      <text>ç”Ÿæˆ AI ç‚¹è¯„</text>
                    </view>
                  </view>
                </view>
              </view>
            </view>
          </view>
        </view>
      </main>
    </view>
  </view>
</view>
